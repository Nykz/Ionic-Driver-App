import{a as Ee}from"./chunk-K5YFKE5S.js";import"./chunk-74W26V3C.js";import{a as xe,b as we,e as Ce,j as Pe,n as ye,u as Ie,y as Se}from"./chunk-LG455DY4.js";import"./chunk-3C7OKRBG.js";import{a as Oe}from"./chunk-E7APRJJL.js";import{b as V}from"./chunk-RZ7UTHTO.js";import"./chunk-CFZVMA6D.js";import{a as be}from"./chunk-ZSWNRFCL.js";import{$a as Q,C as y,Db as ie,Eb as S,Fb as ne,Gb as oe,H as d,J as c,Ja as U,Jb as re,Ka as Y,Kb as E,Lb as le,Mb as ae,Nb as se,Oa as H,Ob as ce,Pb as me,R as r,Rb as O,S as n,Sa as x,T as p,Ta as W,Tb as pe,U as G,Ua as $,Ub as M,V as R,Va as J,Vb as de,X as w,Xa as C,Y as _,Z as u,Za as K,_b as ge,ab as X,bc as k,ec as L,fb as Z,ga as m,gb as ee,gc as fe,ha as j,hc as ue,ja as z,jb as te,lc as T,mc as he,o as v,oa as B,p as b,pc as _e,rc as ve,sc as F,w as D,x as s,y as h,ya as q,za as I}from"./chunk-HSJ3UP2Q.js";import"./chunk-5K2P5JXY.js";import"./chunk-G2NBWZGV.js";import"./chunk-5ZMMP3RU.js";import"./chunk-GBYUAKBO.js";import"./chunk-TFHXA6LG.js";import"./chunk-6L6JLL4O.js";import"./chunk-G3CV3VGG.js";import"./chunk-JX3TYZ34.js";import"./chunk-RUY5SX76.js";import"./chunk-NIOQNOHM.js";import"./chunk-4U6PRYVA.js";import"./chunk-4YKAI63M.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as N,f}from"./chunk-RW4GY4BD.js";function Fe(t,l){t&1&&(r(0,"ion-text",18)(1,"p",19),m(2,"* Please enter your name"),n()())}function Ve(t,l){t&1&&(r(0,"ion-text",18)(1,"p",19),m(2,"* Please enter a valid email address"),n()())}function Ae(t,l){t&1&&(r(0,"ion-text",20),m(1," * Please enter your Phone Number "),n())}function Ne(t,l){t&1&&(r(0,"ion-text",20),m(1," * Please enter a valid Phone Number "),n())}function De(t,l){if(t&1&&(r(0,"ion-text",18),d(1,Ae,2,0,"ion-text",15)(2,Ne,2,0,"ion-text",15),n()),t&2){let o,i=u();s(),c("ngIf",i.form.get("phone").hasError("required")),s(),c("ngIf",!((o=i.form.get("phone"))!=null&&o.hasError("required"))&&(i.form.get("phone").hasError("minlength")||i.form.get("phone").hasError("maxlength")))}}function Ge(t,l){t&1&&(r(0,"ion-text",20),m(1," * Please enter vehicle number "),n())}function Re(t,l){if(t&1){let o=w();r(0,"ion-button",21),_("click",function(){v(o);let e=u();return b(e.onSubmit())}),m(1," Save "),n()}if(t&2){let o=u();c("disabled",!o.form.valid)}}function je(t,l){if(t&1&&(r(0,"div",22)(1,"ion-button",23),p(2,"ion-spinner",24),n()()),t&2){let o=u();s(),c("disabled",!o.form.valid)}}var Me=(()=>{let l=class l{constructor(i,e){this.profileService=i,this.global=e,this.isLoading=!1}ngOnInit(){return f(this,null,function*(){this.initForm()})}initForm(){var i,e,a,g;console.log("profile: ",this.profile),this.form=new J({name:new C((i=this.profile)!=null&&i.name?this.profile.name:"",{validators:[x.required]}),email:new C((e=this.profile)!=null&&e.email?this.profile.email:"",{validators:[x.required]}),phone:new C((a=this.profile)!=null&&a.phone?this.profile.phone:"",{validators:[x.required,x.minLength(10),x.maxLength(10)]}),vehicle:new C((g=this.profile)!=null&&g.vehicle?this.profile.vehicle:"",{validators:[]})}),this.isLoading=!1}onSubmit(){return f(this,null,function*(){var i;if(this.form.valid)try{this.isLoading=!0,console.log(this.form.value);let e=N({},this.form.value);if(console.log("user: ",e),((i=this.profile)==null?void 0:i.email)==e.email){let a=yield this.profileService.updateProfile(this.profile,e);console.log(a),this.global.successToast("Profile Updated Successfully"),this.global.modalDismiss(),this.isLoading=!1}else this.presentPasswordPrompt(e)}catch(e){console.log(e),this.isLoading=!1,this.global.errorToast()}})}presentPasswordPrompt(i){this.global.showAlert("Please enter your password to change your Email Address","Verify",[{text:"Cancel",role:"cancel",handler:()=>{console.log("Confirm Cancel"),this.isLoading=!1}},{text:"Verify",handler:e=>{console.log(e.password),e.password.trim()!=""&&e.password.length>=8?this.updateEmail(i,e.password):this.global.errorToast("Password must be of atleast 8 characters")}}],[{name:"password",type:"password",placeholder:"Enter Password"}])}updateEmail(i,e){return f(this,null,function*(){try{yield this.profileService.updateProfileWithEmail(this.profile,i,e),this.global.modalDismiss(),this.isLoading=!1}catch(a){console.log(a);let g="No Internet Connection";(a.code=="auth/email-already-in-use"||a.code=="auth/wrong-password")&&(g=a.message),this.global.errorToast(g),this.isLoading=!1}})}};l.\u0275fac=function(e){return new(e||l)(h(V),h(F))},l.\u0275cmp=y({type:l,selectors:[["app-edit-profile"]],inputs:{profile:"profile"},decls:31,vars:7,consts:[["slot","start"],["color","dark","fill","clear",3,"click"],["slot","icon-only","name","arrow-back-outline"],[3,"formGroup"],["lines","none",1,"ion-margin-horizontal"],[1,"ion-margin-vertical"],["name","person-outline","slot","start","color","primary"],["type","text","formControlName","name","placeholder","Name"],["color","danger",4,"ngIf"],[1,"ion-margin-bottom"],["name","mail-outline","slot","start","color","primary"],["type","email","formControlName","email","placeholder","Email"],["name","call-outline","slot","start","color","primary"],["type","tel","formControlName","phone","placeholder","Phone","minlength","10","maxlength","10"],["type","text","formControlName","vehicle","placeholder","Vehicle no."],["class","error",4,"ngIf"],["expand","block","type","submit","color","primary","class","ion-margin",3,"disabled","click",4,"ngIf"],["class","ion-text-center",4,"ngIf"],["color","danger"],[1,"errorMsg"],[1,"error"],["expand","block","type","submit","color","primary",1,"ion-margin",3,"click","disabled"],[1,"ion-text-center"],["color","primary",1,"ion-margin",3,"disabled"],["name","circles"]],template:function(e,a){if(e&1&&(r(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),_("click",function(){return a.global.modalDismiss()}),p(4,"ion-icon",2),n()(),r(5,"ion-title"),m(6,"Edit Profile"),n()()(),r(7,"ion-content")(8,"form",3)(9,"ion-list",4)(10,"div",5)(11,"ion-item"),p(12,"ion-icon",6)(13,"ion-input",7),n(),d(14,Fe,3,0,"ion-text",8),n(),r(15,"div",9)(16,"ion-item"),p(17,"ion-icon",10)(18,"ion-input",11),n(),d(19,Ve,3,0,"ion-text",8),n(),r(20,"div",9)(21,"ion-item"),p(22,"ion-icon",12)(23,"ion-input",13),n(),d(24,De,3,2,"ion-text",8),n(),r(25,"div",9)(26,"ion-item"),p(27,"ion-textarea",14),n(),d(28,Ge,2,0,"ion-text",15),n()(),d(29,Re,2,1,"ion-button",16)(30,je,3,1,"div",17),n()()),e&2){let g,P,A;s(8),c("formGroup",a.form),s(6),c("ngIf",!((g=a.form.get("name"))!=null&&g.valid)&&a.form.get("name").touched),s(5),c("ngIf",!((P=a.form.get("email"))!=null&&P.valid)&&a.form.get("email").touched),s(5),c("ngIf",!((A=a.form.get("phone"))!=null&&A.valid)&&a.form.get("phone").touched),s(4),c("ngIf",a.form.get("vehicle").hasError("required")),s(),c("ngIf",!a.isLoading),s(),c("ngIf",a.isLoading)}},dependencies:[he,_e,me,ue,ne,S,T,fe,E,M,O,L,k,I,te,K,W,$,Z,ee,Q,X],styles:["img[_ngcontent-%COMP%]{height:10vh;width:10vh}ion-item[_ngcontent-%COMP%]{border:1px solid var(--ion-color-medium);border-radius:5px}"]});let t=l;return t})();var ze=()=>["/","tabs","reviews"];function Be(t,l){t&1&&(r(0,"div",5),p(1,"ion-spinner",6),n())}function qe(t,l){t&1&&(r(0,"ion-text",15)(1,"p"),m(2,"No Reviews Yet"),n()())}function Ue(t,l){if(t&1&&(r(0,"swiper-slide")(1,"ion-card"),p(2,"app-review",26),n()()),t&2){let o=l.$implicit;s(2),c("review",o)}}function Ye(t,l){if(t&1&&(r(0,"ion-row")(1,"swiper-container",21),d(2,Ue,3,1,"swiper-slide",22),r(3,"swiper-slide")(4,"ion-card",23)(5,"ion-button",24),m(6," VIEW ALL "),p(7,"ion-icon",25),n()()()()()),t&2){let o=u(2);s(),c("modules",o.swiperModules)("slidesPerView",1.1)("keyboard",!0)("centerSlides",!0),s(),c("ngForOf",o.reviews),s(2),c("routerLink",B(6,ze))}}function He(t,l){if(t&1){let o=w();G(0),r(1,"ion-grid",7),p(2,"div",8),r(3,"div",9)(4,"ion-fab",10)(5,"ion-fab-button",11),_("click",function(){v(o);let e=u();return b(e.takePicture())}),p(6,"ion-icon",12),n()(),r(7,"ion-avatar"),p(8,"img",13),n()()(),r(9,"ion-item",14)(10,"ion-label",15)(11,"ion-text",16)(12,"h4"),m(13),n()(),r(14,"p"),m(15),n()()(),r(16,"ion-row",17)(17,"ion-col",18)(18,"ion-button",19),_("click",function(){v(o);let e=u();return b(e.editProfile())}),m(19," Edit Profile "),n()()(),r(20,"ion-list")(21,"ion-list-header")(22,"ion-label",6),m(23,"REVIEWS"),n()(),d(24,qe,3,0,"ion-text",20)(25,Ye,8,7,"ion-row",1),n(),R()}if(t&2){let o=u();s(8),c("src",o.profile!=null&&o.profile.photo?o.profile==null?null:o.profile.photo:"assets/imgs/avatar.png",D),s(5),j(o.profile==null?null:o.profile.name),s(2),z("",o.profile==null?null:o.profile.phone," | ",o.profile==null?null:o.profile.email,""),s(9),c("ngIf",!o.reviews||(o.reviews==null?null:o.reviews.length)==0),s(),c("ngIf",(o.reviews==null?null:o.reviews.length)>0)}}function We(t,l){if(t&1){let o=w();r(0,"ion-button",27),_("click",function(){v(o);let e=u();return b(e.logout())}),m(1," LOGOUT "),n()}}var pt=(()=>{let l=class l{constructor(i,e,a,g,P){this.router=i,this.global=e,this.profileService=a,this.authService=g,this.orderService=P,this.swiperModules=[H],this.isLoading=!1,this.reviews=[],xe({createOutline:ye,star:Se,chevronForwardCircleOutline:Pe,arrowBackOutline:we,mailOutline:Ie,callOutline:Ce})}ngOnInit(){return f(this,null,function*(){yield this.getData(),this.profileSub=this.profileService.profile.subscribe({next:i=>{this.profile=i,console.log(this.profile)}}),this.reviewSub=this.orderService.orderReviews.subscribe({next:i=>{this.reviews=i,console.log("reviews: ",this.reviews)}})})}ionViewDidEnter(){console.log("ionViewDidEnter AccountPage"),this.global.customStatusbar(!0)}getData(){return f(this,null,function*(){try{this.isLoading=!0,yield this.profileService.getProfile(),yield this.orderService.getReviews(3),this.isLoading=!1}catch(i){this.isLoading=!1,console.log("error: ",i),this.global.errorToast()}})}takePicture(){return f(this,null,function*(){try{let i=yield this.global.takePicture();this.global.showLoader();let e=yield this.profileService.updatePicture(i);e&&(this.profile.photo=e.photo,this.global.successToast("Profile picture changed")),this.global.hideLoader()}catch(i){console.log(i),this.global.hideLoader()}})}confirmLogout(){this.global.showAlert("Are you sure you want to sign-out?","Confirm",[{text:"No",role:"cancel"},{text:"Yes",handler:()=>{this.logout()}}])}logout(){return f(this,null,function*(){try{this.global.showLoader(),yield this.authService.logout(),this.router.navigateByUrl(ve.LOGIN,{replaceUrl:!0}),this.global.hideLoader()}catch(i){console.log(i),this.global.hideLoader(),this.global.errorToast("Logout Failed! Check your internet connection")}})}editProfile(){return f(this,null,function*(){let i={component:Me,componentProps:{profile:this.profile},swipeToClose:!0},e=yield this.global.createModal(i)})}ionViewDidLeave(){console.log("ionViewDidLeave AccountPage"),this.global.customStatusbar()}ngOnDestroy(){return f(this,null,function*(){console.log("ondestroy accountpage"),this.profileSub&&this.profileSub.unsubscribe(),this.reviewSub&&this.reviewSub.unsubscribe(),this.profileService.reset()})}};l.\u0275fac=function(e){return new(e||l)(h(U),h(F),h(V),h(be),h(Oe))},l.\u0275cmp=y({type:l,selectors:[["app-account"]],decls:6,vars:3,consts:[["class","ion-text-center alignSpinner",4,"ngIf"],[4,"ngIf"],[1,"ion-no-border"],["color","white"],["color","danger","expand","block",3,"click",4,"ngIf"],[1,"ion-text-center","alignSpinner"],["color","primary"],[1,"main-header"],[1,"bgColor"],["align","center",1,"image"],["vertical","top","horizontal","right"],["color","primary",3,"click"],["name","create-outline"],[3,"src"],["lines","none",1,"profile"],[1,"ion-text-center"],[1,"ion-text-uppercase"],[1,"borderBottom"],["size","12"],["expand","block","size","small","fill","outline",3,"click"],["class","ion-text-center",4,"ngIf"],[3,"modules","slidesPerView","keyboard","centerSlides"],[4,"ngFor","ngForOf"],[1,"ion-text-center",3,"routerLink"],["fill","clear"],["slot","end","name","chevron-forward-circle-outline","color","primary"],[3,"review"],["color","danger","expand","block",3,"click"]],template:function(e,a){e&1&&(r(0,"ion-content"),d(1,Be,2,0,"div",0)(2,He,26,6,"ng-container",1),n(),r(3,"ion-footer",2)(4,"ion-toolbar",3),d(5,We,2,0,"ion-button",4),n()()),e&2&&(s(),c("ngIf",a.isLoading),s(),c("ngIf",!a.isLoading),s(3),c("ngIf",!a.isLoading))},dependencies:[E,k,ce,le,ae,T,ie,O,pe,ge,re,L,S,M,de,oe,se,I,q,Y,Ee],styles:['ion-content[_ngcontent-%COMP%]   .main-header[_ngcontent-%COMP%]{height:29vh}ion-content[_ngcontent-%COMP%]   .main-header[_ngcontent-%COMP%]   .bgColor[_ngcontent-%COMP%]{height:20vh;width:120%;background:linear-gradient(to top,var(--ion-color-secondary) 0%,var(--ion-color-primary) 100%);box-shadow:0 1px 10px var(--ion-color-light);border-radius:0 0 50% 50%;margin-left:-6vh;margin-top:-5px}ion-content[_ngcontent-%COMP%]   .main-header[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{transform:translateY(-10vh)}ion-content[_ngcontent-%COMP%]   .main-header[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{margin:-8px 0 0 20px;width:30px;height:30px}ion-content[_ngcontent-%COMP%]   .main-header[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]   ion-fab-button[_ngcontent-%COMP%]{width:30px;height:30px;--background: transparent}ion-content[_ngcontent-%COMP%]   .main-header[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{position:relative;width:20vh;height:20vh;background:var(--ion-color-white);margin-bottom:5px;border:7px solid var(--ion-color-white)}ion-content[_ngcontent-%COMP%]   .main-header[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;border-radius:50px;padding:3px;background:linear-gradient(to bottom,var(--ion-color-star),#FD1D1D,var(--ion-color-dark),#F56040,#F77737,#FCAF45,#FFDC80);-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:destination-out;mask-composite:exclude}ion-content[_ngcontent-%COMP%]   ion-item.profile[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem!important}ion-content[_ngcontent-%COMP%]   ion-item.profile[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin:0 .2vh;font-size:.8rem}ion-content[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   swiper-container[_ngcontent-%COMP%]{width:100%}ion-content[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   swiper-container[_ngcontent-%COMP%]   swiper-slide[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{height:22vh}ion-content[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   swiper-container[_ngcontent-%COMP%]   swiper-slide[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{transform:translateY(100%)}']});let t=l;return t})();export{pt as AccountPage};
