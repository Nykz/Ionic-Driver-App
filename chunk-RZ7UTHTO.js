import{a as A}from"./chunk-CFZVMA6D.js";import{a as w}from"./chunk-ZSWNRFCL.js";import{c as v,j as b,l as f}from"./chunk-HSJ3UP2Q.js";import{a as g,b as p,f as s}from"./chunk-RW4GY4BD.js";var _=[{email:"nykz786@gmail.com",phone:"9101000000",name:"Nikhil Agarwal",id:"1",type:"user",status:"active"},{email:"technyks@gmail.com",phone:"9101000001",name:"Technyks",id:"2",type:"user",status:"active"},{email:"codingtechnyks@gmail.com",phone:"9101000002",name:"Coding Technyks",id:"3",type:"user",status:"active"},{email:"abc@gmail.com",phone:"9101000003",name:"Ravi S",id:"4",type:"rider",status:"active",vehicle:"DL05DL4321",latitude:28.633249,longitude:77.260472,current_duty:"active"},{email:"xyz@gmail.com",phone:"9101000004",name:"Xavier",id:"5",type:"rider",status:"active",vehicle:"DL05DL3322",latitude:28.633255,longitude:77.219487,current_duty:"active"},{email:"agarwal.piyush@gmail.com",phone:"9101000022",name:"Piyush A",id:"6",type:"restaurant",status:"active"}];var m=class{constructor(a,S,e,t,i,o,r,c,n,l,h,y){this.email=a,this.phone=S,this.name=e,this.id=t,this.type=i,this.status=o,this.photo=r,this.vehicle=c,this.latitude=n,this.longitude=l,this.current_duty=h,this.isOrderActive=y}};var T=(()=>{let a=class a{get profile(){return this._profile.asObservable()}constructor(e,t){this.authService=e,this.api=t,this._profile=new v(null)}getProfile(){return s(this,null,function*(){try{yield this.api.delayedResponse(500);let e=yield this.authService.getId();console.log("uid: ",e);let t;return this._profile.value?t=g({},this._profile.value):(t=_.find(i=>i.id==e),console.log("user: ",t)),console.log("user: ",t),this._profile.next(t),t}catch(e){throw e}})}updateProfile(e,t){return s(this,null,function*(){try{let i=yield this.authService.getId(),o=new m(t.email,t.phone,t.name,i,e.type,e.status,(e==null?void 0:e.photo)||null,t.vehicle,(t==null?void 0:t.latitude)||(e==null?void 0:e.latitude),(t==null?void 0:t.longitude)||(e==null?void 0:e.longitude),e.current_duty);return this._profile.next(o),o}catch(i){throw console.log(i),i}})}updateProfileWithEmail(e,t,i){return s(this,null,function*(){try{return yield this.updateProfile(e,t),e}catch(o){throw o}})}uploadPhoto(e){return s(this,null,function*(){try{let t=Date.now(),i=yield this.getBlob(e);console.log(i);let o=`restaurants/${t}.${e.format}`}catch(t){throw t}})}base64ToImage(e){let t=e.split(","),i=atob(t[1]),o=new ArrayBuffer(i.length),r=new Uint8Array(o);for(let n=0;n<i.length;n++)r[n]=i.charCodeAt(n);return new Blob([o],{type:"image/png"})}getBlob(e){let t=e.base64String;console.log(t);let i="",o=512;t=t.replace(/data\:image\/(jpeg|jpg|png)\;base64\,/gi,"");let r=atob(t),c=[];for(let l=0;l<r.length;l+=o){let h=r.slice(l,l+o),y=new Array(h.length);for(let d=0;d<h.length;d++)y[d]=h.charCodeAt(d);let x=new Uint8Array(y);c.push(x)}return new Blob(c,{type:`image/${e.format}`})}updatePicture(e){return s(this,null,function*(){try{return{cover:e}}catch(t){throw t}})}updateLocation(e,t){return s(this,null,function*(){try{console.log("profile data: ",this._profile.value),this._profile.value||(yield this.getProfile());let i=p(g({},this._profile.value),{latitude:e,longitude:t});return this._profile.next(i),i}catch(i){throw i}})}changeDutyStatus(e){return s(this,null,function*(){try{let t=p(g({},this._profile.value),{current_duty:e});return this._profile.next(t),t}catch(t){throw console.log(t),t}})}reset(){this._profile.next(null)}};a.\u0275fac=function(t){return new(t||a)(f(w),f(A))},a.\u0275prov=b({token:a,factory:a.\u0275fac,providedIn:"root"});let u=a;return u})();export{m as a,T as b};
