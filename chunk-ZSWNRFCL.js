import{Ja as p,c as h,j as d,l as u,m as l,rc as s,sc as g,tc as w}from"./chunk-HSJ3UP2Q.js";import{f as a}from"./chunk-RW4GY4BD.js";var c=class{constructor(r){this.uid=r}},f=(()=>{let r=class r{constructor(t,e){this.router=t,this.storage=e,this._uid=new h(r.UNKNOWN_USER),this.global=l(g)}login(t,e){return a(this,null,function*(){try{let i={email:t,password:e},n={id:"4"};return this.setUserData(n==null?void 0:n.id),n}catch(i){throw i}})}getId(){return a(this,null,function*(){let t=this._uid.value;if(console.log("auth user id: ",t==null?void 0:t.uid),t!=null&&t.uid)return t.uid;{let e=(yield this.storage.getStorage(s.UID)).value;return this._uid.next(new c(e)),e}})}setUserData(t){this.storage.setStorage(s.UID,t),this._uid.next(new c(t))}register(t){return a(this,null,function*(){try{let e=new FormData;e.append("photo",t.imageFile,t.imageFile.name),e.append("name",t.name),e.append("email",t.email),e.append("phone",t.phone),e.append("password",t.password),e.append("vehicle",t==null?void 0:t.vehicle),e.append("type",s.TYPE),e.append("status","active");let i="4";return yield this.setUserData(i),{id:i,type:s.TYPE}}catch(e){throw e}})}sendResetPasswordOtp(t){return a(this,null,function*(){try{let e={email:t};return null}catch(e){throw e}})}verifyResetPasswordOtp(t,e){return a(this,null,function*(){try{let i={email:t,reset_password_token:e};return null}catch(i){throw i}})}resetPassword(t){return a(this,null,function*(){try{return null}catch(e){throw e}})}logout(){return a(this,null,function*(){try{return yield this.storage.removeStorage(s.UID),this._uid.next(r.UNKNOWN_USER),!0}catch(t){throw t}})}updateEmail(t,e,i){return a(this,null,function*(){try{}catch(n){throw console.log(n),n}})}autoLoginGuard(){return a(this,null,function*(){try{return(yield this.getId())?(this.global.navigateByUrl(s.TABS),!1):!0}catch(t){throw t}})}introGuard(){return a(this,null,function*(){let t=yield this.storage.getStorage(s.INTRO_KEY);return t&&t.value=="true"||this.router.navigateByUrl("/intro",{replaceUrl:!0}),!0})}authGuard(){return a(this,null,function*(){try{let t=yield this.getId();return console.log("authguard: ",t),t?(this.setUserData(t),!0):(this.router.navigateByUrl(s.LOGIN,{replaceUrl:!0}),!1)}catch(t){throw t}})}getUserData(){return a(this,null,function*(){let t=yield this.storage.getStorage(s.UID);return{uid:t==null?void 0:t.value}})}};r.UNKNOWN_USER=null,r.\u0275fac=function(e){return new(e||r)(u(p),u(w))},r.\u0275prov=d({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();export{f as a};
